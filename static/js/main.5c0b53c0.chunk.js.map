{"version":3,"sources":["get-files-from-data-transfer.ts","store/actions.ts","store/index.ts","ResetButton.tsx","FileSelector.tsx","FileName.tsx","FileLastModified.tsx","FileSize.tsx","RemoveButton.tsx","CopyButton.tsx","FilesListItem.tsx","FilesList.tsx","App.tsx","use-drag-drop.ts","use-paste.ts","index.tsx"],"names":["SUPPORT_GET_AS_ENTRY","DataTransferItem","prototype","webkitGetAsEntry","getFilesFromFileSystemEntry","entry","a","Promise","resolve","file","getFilesFromFileSystemDirectoryEntry","reader","createReader","readEntries","entries","all","map","getFilesFromEntry","entryFiles","flatten","isFile","isDirectory","Error","getFilesFromDataTransferItem","item","getAsFile","getFilesFromDataTransferItems","items","files","promises","push","getFilesFromDataTransfer","dataTransfer","Array","from","filter","kind","length","isActionReset","action","type","isActionAddFiles","addFiles","payload","name","size","last","Date","lastModified","toISOString","blob","URL","createObjectURL","addDataTransfer","dispatch","isActionRemoveFiles","DEFAULT_STATE","latest","reducer","state","toRemove","blobs","indexOf","useSelector","useReactReduxSelector","getFiles","getLatestBlobURL","hasFiles","ResetButton","useDispatch","handleClick","React","className","onClick","FileSelector","handleChange","e","currentTarget","value","id","multiple","onChange","htmlFor","FileName","children","index","lastIndexOf","filename","substring","extension","data-type","replace","FileLastModified","format","FileSize","filesize","round","RemoveButton","blobURL","title","CopyButton","latestBloblURL","dataURL","setDataURL","buttonText","setButtonText","process","fetch","res","FileReader","addEventListener","String","result","readAsDataURL","handleClickProcess","preventDefault","handleClickCopy","navigator","clipboard","writeText","clock","setTimeout","clearTimeout","FilesListItem","fileDetails","find","getFileDetailsByBlobURL","FilesList","key","App","handleDragover","some","dropEffect","handleDrop","window","removeEventListener","useDragDrop","handlePaste","clipboardData","document","usePaste","showReset","href","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","render","getElementById"],"mappings":"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","file":"static/js/main.5c0b53c0.chunk.js","sourcesContent":["import flatten from 'lodash.flatten';\r\n\r\nconst SUPPORT_GET_AS_ENTRY = typeof DataTransferItem.prototype.webkitGetAsEntry === 'function';\r\n\r\nconst getFilesFromFileSystemEntry = async (entry: FileSystemEntry): Promise<File[]> => {\r\n  const file = await new Promise<File>((resolve) => entry.file(resolve));\r\n  return [file];\r\n};\r\n\r\nconst getFilesFromFileSystemDirectoryEntry = async (entry: FileSystemDirectoryEntry): Promise<File[]> => {\r\n  const reader = entry.createReader();\r\n  const entries = await new Promise<(FileSystemEntry | FileSystemDirectoryEntry)[]>((resolve) => reader.readEntries(resolve));\r\n  const entryFiles = await Promise.all(entries.map(getFilesFromEntry));\r\n  return flatten(entryFiles);\r\n};\r\n\r\nconst getFilesFromEntry = async (entry: FileSystemEntry | FileSystemDirectoryEntry): Promise<File[]> => {\r\n  if (entry.isFile) {\r\n    return getFilesFromFileSystemEntry(entry);\r\n  } else if (entry.isDirectory) {\r\n    return getFilesFromFileSystemDirectoryEntry(entry);\r\n  } else {\r\n    throw new Error('Expected entry to be file or directory');\r\n  }\r\n};\r\n\r\nconst getFilesFromDataTransferItem = async (item: DataTransferItem): Promise<File[]> => {\r\n  const entry = item.webkitGetAsEntry();\r\n  if (entry != null) return getFilesFromEntry(entry);\r\n  const file = item.getAsFile();\r\n  if (file != null) return [file];\r\n  // Something went wrong. Item was of kind 'file' but at this point it\r\n  // did not contain an entry or a file.\r\n  throw new Error('Expected item to be file entry, got null');\r\n};\r\n\r\nconst getFilesFromDataTransferItems = async (items: DataTransferItem[]): Promise<File[]> => {\r\n  const files: File[] = [];\r\n  const promises = items.map(async (item) => {\r\n    files.push(...await getFilesFromDataTransferItem(item));\r\n  });\r\n  await Promise.all(promises);\r\n  return files;\r\n};\r\n\r\nexport const getFilesFromDataTransfer = async (dataTransfer: DataTransfer): Promise<File[]> => {\r\n  const files = dataTransfer.files ? Array.from(dataTransfer.files) : [];\r\n  const items = dataTransfer.items ? Array.from(dataTransfer.items).filter((item) => item.kind === 'file') : [];\r\n  if (items.length && SUPPORT_GET_AS_ENTRY) {\r\n    return getFilesFromDataTransferItems(items);\r\n  }\r\n  return files;\r\n};\r\n","import { Action } from 'redux';\nimport { ThunkAction } from 'redux-thunk';\nimport { SerializedFile } from '../types';\nimport { getFilesFromDataTransfer } from '../get-files-from-data-transfer';\n\n/* Reset action */\n\nexport const ACTION_RESET = 'RESET';\n\nexport interface ActionReset extends Action<typeof ACTION_RESET> { }\n\nexport const isActionReset = (action: Action): action is ActionReset => (\n  action.type === ACTION_RESET\n);\n\nexport const reset = (): ActionReset => ({\n  type: ACTION_RESET,\n});\n\n/* Add files action */\n\nexport const ACTION_ADD_FILES = 'ADD_FILES';\n\nexport interface ActionAddFiles extends Action<typeof ACTION_ADD_FILES> {\n  payload: {\n    files: SerializedFile[];\n  };\n}\n\nexport const isActionAddFiles = (action: Action): action is ActionAddFiles => (\n  action.type === ACTION_ADD_FILES\n);\n\nexport const addFiles = (files: File[] | FileList): ActionAddFiles => ({\n  type: ACTION_ADD_FILES,\n  payload: {\n    files: Array.from(files, (file) => ({\n      name: file.name,\n      size: file.size,\n      type: file.type || null,\n      last: new Date(file.lastModified).toISOString(),\n      blob: URL.createObjectURL(file),\n    })),\n  },\n});\n\nexport const addDataTransfer = (dataTransfer: DataTransfer): ThunkAction<Promise<void>, unknown, void, ActionAddFiles> => async (dispatch) => {\n  const files = await getFilesFromDataTransfer(dataTransfer);\n  if (files.length) {\n    dispatch(addFiles(files));\n  }\n};\n\n/* Remove files action */\n\nexport const ACTION_REMOVE_FILES = 'REMOVE_FILES';\n\nexport interface ActionRemoveFiles extends Action<typeof ACTION_REMOVE_FILES> {\n  payload: {\n    blobs: string[];\n  };\n}\n\nexport const isActionRemoveFiles = (action: Action): action is ActionRemoveFiles => (\n  action.type === ACTION_REMOVE_FILES\n);\n\nexport const removeFile = (blob: string): ActionRemoveFiles => ({\n  type: ACTION_REMOVE_FILES,\n  payload: {\n    blobs: [blob],\n  },\n});\n\nexport const removeFiles = (blobs: string[]): ActionRemoveFiles => ({\n  type: ACTION_REMOVE_FILES,\n  payload: {\n    blobs,\n  },\n});\n","import { Reducer } from 'redux';\nimport { TypedUseSelectorHook, useSelector as useReactReduxSelector } from 'react-redux';\nimport { SerializedFile } from '../types';\nimport { isActionReset, isActionAddFiles, isActionRemoveFiles } from './actions';\n\nexport interface RootReducerState {\n  files: SerializedFile[];\n  latest: string | null;\n}\n\nexport const DEFAULT_STATE: RootReducerState = {\n  files: [],\n  latest: null,\n};\n\nexport const reducer: Reducer<RootReducerState> = (state = DEFAULT_STATE, action) => {\n  if (isActionReset(action)) {\n    return DEFAULT_STATE;\n  }\n\n  if (isActionAddFiles(action)) {\n    return {\n      ...state,\n      files: [\n        ...state.files,\n        ...action.payload.files,\n      ],\n      latest: action.payload.files.length === 1 ? action.payload.files[0].blob : null,\n    };\n  }\n\n  if (isActionRemoveFiles(action)) {\n    let { files, latest } = state;\n    const toRemove = action.payload.blobs;\n    return {\n      ...state,\n      files: files.filter((file) => (\n        toRemove.indexOf(file.blob) < 0\n      )),\n      latest: latest !== null && toRemove.indexOf(latest) < 0 ? latest : null,\n    };\n  }\n\n  return state;\n};\n\nexport default reducer;\n\nexport const useSelector: TypedUseSelectorHook<RootReducerState> = useReactReduxSelector;\n\nexport const getFiles = (state: RootReducerState) => state.files;\n\nexport const getFileDetailsByBlobURL = (state: RootReducerState, blobURL: string) => (\n  state.files.find((file) => file.blob === blobURL) || null\n);\n\nexport const getLatestBlobURL = (state: RootReducerState) => state.latest;\n\nexport const hasFiles = (state: RootReducerState) => state.files.length > 0;\n","import * as React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { reset } from './store/actions';\r\n\r\nconst ResetButton: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const handleClick = React.useCallback(() => {\r\n    dispatch(reset());\r\n  }, [dispatch]);\r\n  return (\r\n    <button\r\n      className=\"btn btn-danger\"\r\n      type=\"button\"\r\n      onClick={handleClick}\r\n    >\r\n      Clear all files\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default ResetButton;\r\n","import * as React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { addFiles } from './store/actions';\r\n\r\nconst FileSelector: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const handleChange = React.useCallback<React.ChangeEventHandler<HTMLInputElement>>((e) => {\r\n    if (e.currentTarget.files) {\r\n      dispatch(addFiles(e.currentTarget.files));\r\n      // Clear file input. Allows the same file to be selected twice.\r\n      // This is necessary if the user clears the file list but wants\r\n      // to add the same file again afterwards.\r\n      e.currentTarget.value = '';\r\n    }\r\n  }, [dispatch]);\r\n  return (\r\n    <div className=\"custom-file\">\r\n      <input\r\n        id=\"FileSelector\"\r\n        type=\"file\"\r\n        multiple={true}\r\n        onChange={handleChange}\r\n      />\r\n      <label\r\n        className=\"custom-file-label\"\r\n        htmlFor=\"FileSelector\"\r\n      >\r\n        Choose files\r\n      </label>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileSelector;\r\n","import * as React from 'react';\r\nimport './FileName.css';\r\n\r\nexport interface Props {\r\n  children: string;\r\n}\r\n\r\nconst FileName: React.FC<Props> = ({ children }) => {\r\n  let index = children.lastIndexOf('.');\r\n  if (index === -1) index = children.length;\r\n  const filename = children.substring(0, index);\r\n  const extension = children.substring(index);\r\n  return (\r\n    <div className=\"FileName\">\r\n      <span\r\n        className=\"FileName-file-icon file-icon file-icon-xs mr-2\"\r\n        data-type={extension.replace(/^\\./, '')}\r\n      />\r\n      <span className=\"FileName-file-name\">{filename}</span>\r\n      {extension && <span className=\"FileName-extension\">{extension}</span>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileName;\r\n","import * as React from 'react';\nimport format from 'date-fns/format';\n\nexport interface Props {\n  children: string;\n}\n\nconst FileLastModified: React.FC<Props> = ({ children }) => {\n  return <>{format(new Date(children), 'EEE d MMMM yyyy \\'at\\' h:mm a')}</>;\n};\n\nexport default FileLastModified;\n","import * as React from 'react';\nimport filesize from 'filesize';\n\nexport interface Props {\n  children: number;\n}\n\nconst FileSize: React.FC<Props> = ({ children }) => {\n  return <>{filesize(children, { round: 0 })}</>;\n};\n\nexport default FileSize;\n","import * as React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { removeFile } from './store/actions';\n\nexport interface Props {\n  blob: string;\n}\n\nconst RemoveButton: React.FC<Props> = ({ blob: blobURL }) => {\n  const dispatch = useDispatch();\n  const handleClick = React.useCallback(() => {\n    dispatch(removeFile(blobURL));\n  }, [dispatch, blobURL]);\n  return (\n    <button\n      className=\"btn btn-light\"\n      type=\"button\"\n      onClick={handleClick}\n      title=\"Remove this file\"\n    >\n      &times;\n    </button>\n  );\n};\n\nexport default RemoveButton;\n","import * as React from 'react';\r\nimport { useSelector, getLatestBlobURL } from './store';\r\n\r\nexport interface Props {\r\n  blob: string;\r\n}\r\n\r\nconst CopyButton: React.FC<Props> = ({ blob: blobURL }) => {\r\n  const latestBloblURL = useSelector(getLatestBlobURL);\r\n  const [dataURL, setDataURL] = React.useState<string | null>(null);\r\n  const [buttonText, setButtonText] = React.useState<string | null>(null);\r\n  const process = React.useCallback(async () => {\r\n    try {\r\n      const res = await fetch(blobURL);\r\n      const blob = await res.blob();\r\n      const reader = new FileReader();\r\n      reader.addEventListener('load', () => {\r\n        setDataURL(String(reader.result));\r\n      });\r\n      reader.readAsDataURL(blob);\r\n    } catch (err) {\r\n      // TODO: Handle error\r\n    }\r\n  }, [blobURL]);\r\n  const handleClickProcess = React.useCallback<React.MouseEventHandler<HTMLButtonElement>>((e) => {\r\n    e.preventDefault();\r\n    process();\r\n  }, [process]);\r\n  const handleClickCopy = React.useCallback<React.MouseEventHandler<HTMLButtonElement>>(async (e) => {\r\n    e.preventDefault();\r\n    if (dataURL !== null) {\r\n      await navigator.clipboard.writeText(dataURL);\r\n      setButtonText('Copied!');\r\n    }\r\n  }, [dataURL]);\r\n  React.useEffect(() => {\r\n    if (blobURL === latestBloblURL) {\r\n      process();\r\n    }\r\n  }, [blobURL, latestBloblURL, process]);\r\n  React.useEffect(() => {\r\n    if (buttonText !== null) {\r\n      const clock = setTimeout(() => {\r\n        setButtonText(null);\r\n      }, 1000);\r\n      return () => clearTimeout(clock);\r\n    }\r\n  }, [buttonText]);\r\n  if (dataURL === null) {\r\n    return (\r\n      <button\r\n        className=\"btn btn-light\"\r\n        type=\"button\"\r\n        onClick={handleClickProcess}\r\n      >\r\n        Generate\r\n      </button>\r\n    );\r\n  } else {\r\n    return (\r\n      <button\r\n        className=\"btn btn-dark\"\r\n        type=\"button\"\r\n        onClick={handleClickCopy}\r\n      >\r\n        {buttonText || 'Copy'}\r\n      </button>\r\n    );\r\n  }\r\n};\r\n\r\nexport default CopyButton;\r\n","import * as React from 'react';\r\nimport { useSelector, getFileDetailsByBlobURL } from './store';\r\nimport FileName from './FileName';\r\nimport FileLastModified from './FileLastModified';\r\nimport FileSize from './FileSize';\r\nimport RemoveButton from './RemoveButton';\r\nimport CopyButton from './CopyButton';\r\nimport './FilesListItem.css';\r\n\r\nexport interface Props {\r\n  blob: string;\r\n}\r\n\r\nconst WARNING_SIZE = 1000000;\r\n\r\nconst FilesListItem: React.FC<Props> = ({ blob: blobURL }) => {\r\n  const fileDetails = useSelector((state) => getFileDetailsByBlobURL(state, blobURL));\r\n  if (!fileDetails) return null;\r\n  return (\r\n    <div className=\"FilesListItem card card-body mb-3\">\r\n      <div className=\"FilesListItem-grid\">\r\n        <div className=\"FilesListItem-name\">\r\n          <FileName>{fileDetails.name}</FileName>\r\n        </div>\r\n        <div className=\"FilesListItem-last-modified\">\r\n          <span className=\"text-secondary\"><FileLastModified>{fileDetails.last}</FileLastModified></span>\r\n        </div>\r\n        <div className=\"FilesListItem-file-type\">\r\n          <span className=\"text-secondary\">{fileDetails.type || <em>unknown</em>}</span>\r\n          {' '}<span className=\"text-secondary\">&bull;</span>{' '}\r\n          <span className={fileDetails.size > WARNING_SIZE ? 'text-warning' : 'text-primary'}><FileSize>{fileDetails.size}</FileSize></span>\r\n        </div>\r\n        <div className=\"FilesListItem-copy\">\r\n          <CopyButton blob={blobURL} />\r\n        </div>\r\n        <div className=\"FilesListItem-remove\">\r\n          <RemoveButton blob={blobURL} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FilesListItem;\r\n","import * as React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { getFiles } from './store';\r\nimport FilesListItem from './FilesListItem';\r\n\r\nconst FilesList: React.FC = () => {\r\n  const files = useSelector(getFiles);\r\n  return (\r\n    <ol className=\"list-unstyled\">\r\n      {files.map((file) => (\r\n        <li key={file.blob}>\r\n          <FilesListItem blob={file.blob} />\r\n        </li>\r\n      ))}\r\n    </ol>\r\n  );\r\n};\r\n\r\nexport default FilesList;\r\n","import * as React from 'react';\nimport { useSelector } from 'react-redux';\nimport { useDragDrop } from './use-drag-drop';\nimport { usePaste } from './use-paste';\nimport { hasFiles } from './store';\nimport ResetButton from './ResetButton';\nimport FileSelector from './FileSelector';\nimport FilesList from './FilesList';\n\nconst App: React.FC = () => {\n  useDragDrop();\n  usePaste();\n  const showReset = useSelector(hasFiles);\n  return (\n    <div className=\"App container mt-5 mb-5\">\n      <a href=\"https://skeoh.com/\" className=\"text-secondary\">&larr; skeoh.com</a>\n      <h1 className=\"mb-5\">File to data URL</h1>\n      <p>Drop a file into this window to generate a data URL. You can also use copy+paste or the file browser below.</p>\n      <div className=\"container px-1 my-3\">\n        <div className=\"row mx-n2\">\n          <div className=\"col-sm px-1\"><FileSelector /></div>\n          {showReset && <div className=\"col-auto px-1\"><ResetButton /></div>}\n        </div>\n      </div>\n      <FilesList />\n    </div>\n  );\n};\n\nexport default App;\n","import * as React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { addDataTransfer } from './store/actions';\r\n\r\nexport const useDragDrop = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  React.useEffect(() => {\r\n    const handleDragover = (e: DragEvent) => {\r\n      if (!e.dataTransfer) return;\r\n      const kinds = Array.from(e.dataTransfer.items, (item) => item.kind);\r\n      const hasFiles = kinds.some((kind) => kind === 'file');\r\n      e.dataTransfer.dropEffect = hasFiles ? 'copy' : 'none';\r\n      if (hasFiles) {\r\n        e.preventDefault();\r\n      }\r\n    };\r\n    const handleDrop = (e: DragEvent) => {\r\n      e.preventDefault();\r\n      if (e.dataTransfer) {\r\n        dispatch(addDataTransfer(e.dataTransfer));\r\n      }\r\n    };\r\n    window.addEventListener('dragover', handleDragover);\r\n    window.addEventListener('drop', handleDrop);\r\n    return () => {\r\n      window.removeEventListener('dragover', handleDragover);\r\n      window.removeEventListener('drop', handleDrop);\r\n    };\r\n  });\r\n};\r\n","import * as React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { addDataTransfer } from './store/actions';\n\nexport const usePaste = () => {\n  const dispatch = useDispatch();\n\n  React.useEffect(() => {\n    const handlePaste = (e: ClipboardEvent) => {\n      if (e.clipboardData) {\n        dispatch(addDataTransfer(e.clipboardData));\n      }\n    };\n    document.addEventListener('paste', handlePaste);\n    return () => {\n      document.removeEventListener('paste', handlePaste);\n    };\n  });\n};\n","import * as React from 'react';\nimport { render } from 'react-dom';\nimport { createStore, applyMiddleware } from 'redux';\nimport rootReducer from './store';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport { Provider as StoreProvider } from 'react-redux';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport 'fileicon.css/fileicon.css';\n\nconst store = createStore(rootReducer, composeWithDevTools(\n  applyMiddleware(thunk),\n));\n\nrender(\n  <StoreProvider store={store}>\n    <App />\n  </StoreProvider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}